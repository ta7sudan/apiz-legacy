/**
 * @Version 0.1.0
 * @Author: ta7sudan
 * @Repo: https://github.com/ta7sudan/apiz-legacy#readme
 * @License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self)["apiz-legacy"]={})}(this,function(e){"use strict";var b,v,g,E,t=Map.call.bind(Object.prototype.toString),j=function(e){return e&&"string"==typeof e},R=function(e){return"function"==typeof e},U=function(e){return"[object Object]"===t(e)},w=/:((\w|-)+)/g,O=/\/\//g,x=function(e,t){return t<=6?e:"/"};function L(e,t,r){var n,o,i,a=r.baseURL,s=r.paramRegex,u=r.querystring,c=r.client,p=t.method,f=void 0===p?"GET":p,d=t.type,l=void 0===d?E:d,h=t.meta;if("add"===e)throw new Error('"add" is preserved key.');!function(e){return!!e.url}(t)?(o=t.baseURL,i=t.path):n=t.url;var y={},m=o||a;if(!U(t))throw new TypeError("API "+e+" expected an object, but received "+JSON.stringify(t)+".");if(j(n))y.url=n;else{if(!j(m))throw new Error('API "'+e+'" must set url or baseURL correctly.');y.url=(m+(i||"")).replace(O,x)}var b=f.toUpperCase(),v=f.toLowerCase();if(-1===["GET","HEAD","POST","PUT","PATCH","DELETE","OPTIONS"].indexOf(b))throw new Error("Unsupported HTTP method: "+b+".");if(!R(c[v]))throw new Error("client must implement a "+v+" function.");var g=y.url.split(/\/(?=\w|:)/g),w=/^(https?:|\/)/.test(g[0])?2:1;return y.baseURL=g.slice(0,w).join("/"),y.path="/"+g.slice(w).join("/"),y.name=e,y.meta=h,y.method=b,y.methodLowerCase=v,y.client=c,y.type=l,y.regex=s,y.querystring=u,y.init=!0,y}function n(e,t){var r,n=this.methodLowerCase,o=this.type,i=this.regex,a=this.querystring,s=this.baseURL,u=this.path,c=this.client,p=this.meta,f=e||{},d=f.query,l=f.params,h=f.body,y=f.headers,m=f.type,b=f.handleError,v=this.url;return!0===t?c[n]({url:v,name:this.name,handleError:b,options:e}):(void 0===m&&(m=o),l&&(v=s+u.replace(i,function(r){return function(e,t){if(null==r[t])throw new Error("Can't find a property \""+t+'" in params.');return encodeURIComponent(r[t])}}(l))),d&&(r=a(d),v=-1!==v.indexOf("?")?v+"&"+r:v+"?"+r),c[n]({url:v,name:this.name,handleError:b,meta:p,type:m,body:h,headers:y,query:d}))}function T(t){var r=n.bind(t);return["url","method","meta","type"].forEach(function(e){Object.defineProperty(r,e,{value:t[e],enumerable:!0,writable:!0})}),r}function r(e){var t=void 0===e?{reset:!0}:e,r=t.querystring,n=t.paramRegex,o=t.client,i=t.reset,a=t.defaultType;R(r)&&(b=r),n instanceof RegExp&&(v=n),g=o,E=a,i&&(b=v=g=E=void 0)}r({querystring:function(e){return"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e).map(function(t){return Array.isArray(e[t])?e[t].map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(null==e?"":e)}).join("&"):encodeURIComponent(t)+"="+encodeURIComponent(null==e[t]?"":e[t])}).join("&"):"string"==typeof e?e:JSON.stringify(e)},defaultType:"json"}),e.APIz=function e(t,r){var n,o,i,a,s=this instanceof e?this:Object.create(e.prototype);j(t.baseURL)&&(n=t.baseURL);var u=r||{},c=u.baseURL;n=void 0===c?n:c;var p=u.paramRegex;o=void 0===p?v||w:p;var f=u.querystring,d=u.client;if(a=void 0===d?g:d,!R(i=void 0===f?b:f))throw new Error("A querystring function must set.");if(!a)throw new Error("A client must set.");var l={baseURL:n,paramRegex:o,querystring:i,client:a},h=t.apis;for(var y in h)if(U(h[y])){var m=L(y,h[y],l);Object.defineProperty(s,y,{value:T(m),writable:!1})}else console.warn("The "+y+" in group is not an object.");return s.add=function(e,t){if(this[e])throw new Error('API "'+e+'" already exists.');var r=L(e,t,l);return this[e]=T(r),this},s},e.config=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=apiz.min.js.map
